/*=====================================================================*/
/*    .../widget/node_modules/flipcounter/lib/flipcounter.js           */
/*    -------------------------------------------------------------    */
/*    Author      :  Manuel Serrano                                    */
/*    Creation    :  Wed Jun  4 08:13:26 2014                          */
/*    Last change :  Wed Jun 11 19:38:29 2014 (serrano)                */
/*    Copyright   :  2014 Manuel Serrano                               */
/*    -------------------------------------------------------------    */
/*    Server Side flipcounter                                          */
/*=====================================================================*/

var hop = require( "hop" );
var path = require( "path" );

var dir = path.dirname( hop.srcDir() );

function FLIPCOUNTER( attributes ) {
   var id = attributes.id;
   var klass = attributes.class;

   delete attributes.id;
   delete attributes.klass;
   
   return <DIV> {
      "data-hss-tag": "flipcounter",
      id: id,
      class: klass,
      attributes,
      ~{
	 window.addEventListener(
	    "load",
	    function() {
	       var el = document.getElementById( ${id} );
	       var fc = new flipCounter( ${id}, ${attributes} );
	       
	       el.flipcounter = fc;
	       fc.__proto__ = el.__proto__;
	       el.__proto__ = fc;
	    } )
      }
   }
}

exports.FLIPCOUNTER = FLIPCOUNTER;

exports.script = path.join( dir, "client", "flipcounter.min.js" );
exports.css = path.join( dir, "hss", "flipcounter.hss" );

Object.seal( exports );
Object.freeze( exports );


