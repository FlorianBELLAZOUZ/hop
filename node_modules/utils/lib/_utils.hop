;*=====================================================================*/
;*    .../prgm/project/hop/hop/node_modules/system/lib/_utils.hop      */
;*    -------------------------------------------------------------    */
;*    Author      :  Manuel Serrano                                    */
;*    Creation    :  Sun Jan 17 07:28:50 2021                          */
;*    Last change :                                                    */
;*    Copyright   :  2021 Manuel Serrano                               */
;*    -------------------------------------------------------------    */
;*    Hop native JS system implementation                              */
;*=====================================================================*/

;*---------------------------------------------------------------------*/
;*    The module                                                       */
;*---------------------------------------------------------------------*/
(module _utils

   (library hopscript hop hopwidget nodejs)
   
   (export (hopscript ::JsGlobalObject ::JsObject ::JsObject ::JsObject)))

;*---------------------------------------------------------------------*/
;*    hopscript ...                                                    */
;*---------------------------------------------------------------------*/
(define (hopscript %this this scope module)
   
   (&with!
      (with-access::JsGlobalObject %this (__proto__ worker)
	 
	 (define exports (js-get module (& "exports") %this))
	 
	 ;; bind the module in the systime scope
	 (js-put! scope (& "module") module #f %this)

	 #unspecified)))

;*---------------------------------------------------------------------*/
;*    The return value for dynamic-load                                */
;*---------------------------------------------------------------------*/
hopscript

