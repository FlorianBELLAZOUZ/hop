;*=====================================================================*/
;*    serrano/prgm/project/hop/3.0.x/node_modules/hss/lib/_hss.hop     */
;*    -------------------------------------------------------------    */
;*    Author      :  Manuel Serrano                                    */
;*    Creation    :  Fri Jun 19 13:21:01 2015                          */
;*    Last change :  Thu Aug 13 13:30:15 2015 (serrano)                */
;*    Copyright   :  2015 Manuel Serrano                               */
;*    -------------------------------------------------------------    */
;*    Hop hss manager                                                 */
;*=====================================================================*/

;*---------------------------------------------------------------------*/
;*    The module                                                       */
;*---------------------------------------------------------------------*/
(module _hss
   
   (library hopscript hop hopwidget nodejs)
   
   (export (hopscript ::JsGlobalObject ::JsObject ::JsObject ::JsObject)))
	   
;*---------------------------------------------------------------------*/
;*    hopscript ...                                                    */
;*---------------------------------------------------------------------*/
(define (hopscript %this this scope module)
   
   (let ((exports (js-get module 'exports %this)))
      
      (js-bind! %this exports 'parseWebColor
	 :value (js-make-function %this
		   (lambda (this color)
		      (hopjs-parse-web-color (js-tostring color %this) %this))
		   1 "parseWeColor"))
      
      (js-bind! %this exports 'makeWebColor
	 :value (js-make-function %this
		   (lambda (this r g b)
		      (make-hex-color r g b))
		   3 "makeWebColor"))

      exports))

;*---------------------------------------------------------------------*/
;*    hopjs-parse-web-color ...                                        */
;*---------------------------------------------------------------------*/
(define (hopjs-parse-web-color color %this)
   (with-access::JsGlobalObject %this (js-object)
      (multiple-value-bind (r g b)
	 (parse-web-color color)
	 (let ((obj (js-new %this js-object)))
	    (js-put! obj 'red r #f %this)
	    (js-put! obj 'green g #f %this)
	    (js-put! obj 'blue b #f %this)
	    obj))))

