/*=====================================================================*/
/*    .../prgm/project/hop/hop/node_modules/openpgp/doc/verify.js      */
/*    -------------------------------------------------------------    */
/*    Author      :  Manuel Serrano                                    */
/*    Creation    :  Thu Feb  4 08:26:09 2021                          */
/*    Last change :  Thu Feb  4 11:17:55 2021 (serrano)                */
/*    Copyright   :  2021 Manuel Serrano                               */
/*    -------------------------------------------------------------    */
/*    Example of openpgp module                                        */
/*=====================================================================*/
"use hopscript";

import { readKey, KeyRing, sign } from hop.openpgp;

// sign
const [ skey ] = readKey( "./example.skey" );
const sig = sign( "JavaScript is not Scheme" , 
   skey, key => "foobargee", { detachedSignature: false } );

// verify
const [ pkey ] = readKey( "./example.pkey" );

console.log( "signature message:", sig.signatureMessage() );

const keyRing = new KeyRing( skey );
const signers = sig.verify( keyRing );

signers.forEach( sk => console.log( sk.toString() ) );
