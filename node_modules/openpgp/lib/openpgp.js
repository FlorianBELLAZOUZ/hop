/*=====================================================================*/
/*    .../prgm/project/hop/hop/node_modules/openpgp/lib/openpgp.js     */
/*    -------------------------------------------------------------    */
/*    Author      :  Manuel Serrano                                    */
/*    Creation    :  Wed Feb  3 17:43:16 2021                          */
/*    Last change :                                                    */
/*    Copyright   :  2021 Manuel Serrano                               */
/*    -------------------------------------------------------------    */
/*    JavaScript OpenPGP binding.                                      */
/*=====================================================================*/
"use hopscript";

/*---------------------------------------------------------------------*/
/*    imports                                                          */
/*---------------------------------------------------------------------*/
const fs = require( "fs" );
const _openpgp = require( "./_openpgp.hop" );

/*---------------------------------------------------------------------*/
/*    readKeyFile ...                                                  */
/*---------------------------------------------------------------------*/
export const Key = _openpgp.Key;
export const readKey = _openpgp.readKey;
export const KeyRing = _openpgp.KeyRing;

/*---------------------------------------------------------------------*/
/*    encrypt/decrypt ...                                              */
/*---------------------------------------------------------------------*/
export function encrypt( msg, keys = [], passwords = [],  o = {} ) {
   const { hashAlgo = "sha256", symmetricAlgo = "cast5" } = o;
   return _openpgp.encrypt( msg, keys, passwords, hashAlgo, symmetricAlgo );
}

/*---------------------------------------------------------------------*/
/*    sign/verify ...                                                  */
/*---------------------------------------------------------------------*/
export function sign( msg, key, passwordProvider, o = {} ) {
   const { detachedSignature = true, onePass = false, hashAlgo = "sha256" } = o;
   return _openpgp.sign( msg, key, passwordProvider, detachedSignature, 
      onePass, hashAlgo );
}

/*---------------------------------------------------------------------*/
/*    exports                                                          */
/*---------------------------------------------------------------------*/
exports.Key = Key;
exports.readKey = readKey;
exports.KeyRing = KeyRing;
exports.encrypt = encrypt;
exports.sign = sign;
