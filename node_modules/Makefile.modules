#*=====================================================================*/
#*    serrano/prgm/project/hop/hop/node_modules/Makefile.modules       */
#*    -------------------------------------------------------------    */
#*    Author      :  Manuel Serrano                                    */
#*    Creation    :  Fri Oct 20 07:47:22 2017                          */
#*    Last change :  Mon May 18 07:48:31 2020 (serrano)                */
#*    Copyright   :  2017-20 Manuel Serrano                            */
#*    -------------------------------------------------------------    */
#*    Common Makefile to build nodejs_modules                          */
#*=====================================================================*/

#*---------------------------------------------------------------------*/
#*    Configuration                                                    */
#*---------------------------------------------------------------------*/
-include ../../../etc/Makefile.hopconfig
-include ../../../etc/Makefile.version
-include $(BIGLOOLIBDIR)/Makefile.config
-include $(BIGLOOLIBDIR)/Makefile.misc

HOPCLOSELIBS_S = $(BGLCLOSELIBS_S) \
  -ljs2scheme_s-$(HOPRELEASE) -lhopscript_s-$(HOPRELEASE) \
  -lhop_s-$(HOPRELEASE) -lhopscheme_s-$(HOPRELEASE) \
  -lnodejs_s-$(HOPRELEASE) -lhopwidget_s-$(HOPRELEASE)
HOPCLOSELIBS_U = $(BGLCLOSELIBS_U) \
  -ljs2scheme_u-$(HOPRELEASE) -lhopscript_u-$(HOPRELEASE) \
  -lhop_u-$(HOPRELEASE) -lhopscheme_u-$(HOPRELEASE) \
  -lnodejs_u-$(HOPRELEASE) -lhopwidget_u-$(HOPRELEASE)
RPATH += $(HOPLIBDIR)/$(HOPFILDIR)

DIR = node_modules/$(PACKAGE)/lib
LIBSDIR = hop/$(HOPRELEASE)/$(DIR)/so/$(HOPRELEASE)/$(HOPBUILDID)/$(MACH)

shared-lib:
	if [ "$(THREADS)" = "yes" ]; then \
          $(MAKE) bigloo-shared-lib LIBSUFFIXTHREAD=_mt; \
        else \
          $(MAKE) bigloo-shared-lib LIBSUFFIXTHREAD=; \
        fi

