<doc> HZ -- Hop weblets manager

== Description ==

[[hz|HZ]] manages Hop weblets //installation//, //update//, and //removal//. 
It operates installation across the web.

== User Services ==

HZ defines several services:

  - ++[[hz]]++: This is the main entry point for HZ. It shows a
 graphical user interface that lets user update their system (i.e., make
 it in sync with the remote global Hop weblets server).
  - ++[[hz/preferences]]++: Lets user customize HZ.
  - ++hz/install-ondemand++: This lets users install weblet not registered
 in the global remote HZ repository. It service takes two arguments:
   - ++name++, the name of the weblet
   - ++url++, the url (that could use the ++file://++ syntax) specifying the
 location of the weblet. 
  - ++hz/list++: Produce a HTML page displaying all the available weblets.


== Administration Services ==

HZ can be administrated (packages managed) with the following services:

  - ++[[hz/repository]]++. This service requires administration rights. This
 service update or create a HZ database. In particular, this system must be
 used to initialize the HZ database.
  - ++[[hz/upload]]++. This service requires administration rights. It allows
 a contributor which is granted administration rights to upload a new package 
 onto the server disk. The service updates the HZ database automatically.
 Adding a package can be also be done //manually//. It only requires to 
 copy the ++.hz++ file in its dedicated directory on the disk of the server
 running ++[[hz]]++ and to proceed to an //update// via the 
 ++[[hz/repository]]++ service.


=== Package file name ===

The name of the files holding HZ package must **strictly** conform
rules enforced by the system. A badly formed HZ package file name cannot
be added into the HZ database. The language defining the HZ package file
named is defined by the following regular expression:

  (.*)-[0-9]+[.][0-9]+(?:[.][0-9]+)?(?:-(?:r|rc|pre)[0-9]+)?.hz


Here is a list of example of correct HZ file names:

  hoptris-1.0.hz
  hop_tris-1.0.hz
  hopslide-1.4.0-rc2.hz


It should be noted that hyphen can only used in HZ package for separating
the base name of the package and its version number.

== Making a weblet available to others ==

The best way to make a weblet available to the HOP community is to 
contact the authors of HOP for adding your weblet to the Hz database.

~~ Another solution consists in distributing your weblet by yourself,
via a Web page. You can distribute HOP weblets that can installed with
one click even without explicitly using the ++[[hz]]++ weblet. If the
Web page Web referring to the weblet is implemented in HOP, it should
contain the following:

  (<HTML>
     (<HEAD> 
        ... 
        :jscript (string-append (hop-weblets-directory) "/hz/hz-install.js")
        ...)
     (<BODY> 
        ...
        ~(hop_install_weblet 
             "http://mhost.mydomain.org/myweblet-1.0.0.hz"
             (string-append (hop-weblets-directory) "/hz/etc/hz-install.png"))
        ...))


If the page is implemented in HTML, it should contain:

   <html>
     <head>
       ...
       <script src='/usr/local/share/hop/weblets/hz/hz-install.js'>
       ...
     </head>
     <body>
       ...
       <script>hop_install_weblet( "http://mhost.mydomain.org/myweblet-1.0.0.hz" )</script>
       ...
     </body>
   </body>


In that case, don't forget to copy the image ++hz-install.png++ in the
same directory as the directory containing the web page.
       
</doc>

